<div class="card shadow-lg border-2 border-success mb-4">
    <div class="card-header bg-light text-dark d-flex justify-content-between align-items-center border-bottom-0">
        <h5 class="mb-0">üõ£Ô∏è Mes trajets</h5>
        <button class="btn btn-primary btn-sm">+ Ajouter un trajet</button>
    </div>

    <div class="card-body">
        <div class="list-group" id="tripList">
            <!-- Le JS va injecter le contenu ici -->
        </div>
    </div>
</div>
<script>
async function fetchTripProfile() {
    try {
        const tripList = document.getElementById('tripList');
        const url = '{{ path("app_api_profile_trip") }}';

        const response = await fetch(url);
        const tripData = await response.json();

        // üõë Cas : aucun trajet (tableau vide)
        if (Array.isArray(tripData) && tripData.length === 0) {
            tripList.innerHTML = `
                <div class="list-group-item text-muted">
                    Vous n'avez pas encore de trajet.
                </div>
            `;
            return;
        }

        // üõë Cas : message
        if (tripData.message) {
            tripList.innerHTML = `
                <div class="list-group-item text-muted">
                    ${tripData.message}
                </div>
            `;
            return;
        }

        // üü¢ Normal : tableau de trajets
        let items = "";
        tripData.forEach(trip => {
            const departure = new Date(trip.departureAt);
            const arrival   = new Date(trip.arrivalAt);

            const options = { 
                day: '2-digit', month: '2-digit', year: 'numeric',
                hour: '2-digit', minute: '2-digit'
            };

            const departureFormatted = departure.toLocaleString('fr-FR', options);
            const arrivalFormatted   = arrival.toLocaleString('fr-FR', options);

            items += `
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <strong>${trip.departure} ‚Üí ${trip.arrival}</strong><br>
                        <small>${departureFormatted} ‚Üí ${arrivalFormatted}</small>
                    </div>
                    <span class="badge bg-info">Places : ${trip.seats}</span>
                </div>
            `;
        });

        tripList.innerHTML = items;

    } catch (error) {
        console.error('Erreur fetchTripProfile:', error);
    }
}

fetchTripProfile();
setInterval(fetchTripProfile, 30000);
</script>
